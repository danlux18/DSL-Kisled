// File generated by ArduinoML (C/yacc/lex)

#define NOTE_A 880
#define NOTE_B 988
#define NOTE_C 523
#define NOTE_D 587
#define NOTE_E 659
#define NOTE_F 698
#define NOTE_G 784

#define OFF LOW
#define ON HIGH
#define SHORT 1000
#define LONG 3000

long time = 0;
long debounce = 200;

int buzzer = 9;
int led = 8;
int button2 = 10;
int button1 = 11;

void setup() {
  pinMode(buzzer, OUTPUT);
  pinMode(led, OUTPUT);
  pinMode(button2, INPUT);
  pinMode(button1, INPUT);
}

void do_action(int actuator, int act_signal, int value, boolean guard) {
  if (!guard) return;
  if (act_signal == OFF || act_signal == ON) {
    digitalWrite(actuator, act_signal);
  } else {
    tone(actuator, value, 1000 / 1);
    delay(act_signal);
    noTone(actuator);
  }
}

void state_on(boolean act_guard) {
  do_action(led, ON, HIGH, act_guard);
  do_action(buzzer, SHORT, NOTE_C, act_guard);
  delay(SHORT);
  do_action(buzzer, SHORT, NOTE_C, act_guard);
  delay(SHORT);
  do_action(buzzer, SHORT, NOTE_C, act_guard);
  boolean guard =  millis() - time > debounce;
  if (digitalRead(button1) == LOW && guard) {
    time = millis();
    state_off(true);
  } else if (digitalRead(button2) == LOW && guard) {
    time = millis();
    state_off(true);
  } else  {
    state_on(false);
  }
}

void state_do(boolean act_guard) {
  do_action(buzzer, SHORT, NOTE_C, act_guard);
  boolean guard =  millis() - time > debounce;
  if (digitalRead(button1) == HIGH && guard) {
    time = millis();
    state_re(true);
  } else  {
    state_do(false);
  }
}

void state_re(boolean act_guard) {
  do_action(buzzer, SHORT, NOTE_D, act_guard);
  boolean guard =  millis() - time > debounce;
  if (digitalRead(button1) == HIGH && guard) {
    time = millis();
    state_mi(true);
  } else  {
    state_re(false);
  }
}

void state_mi(boolean act_guard) {
  do_action(buzzer, SHORT, NOTE_E, act_guard);
  boolean guard =  millis() - time > debounce;
  if (digitalRead(button1) == HIGH && guard) {
    time = millis();
    state_fa(true);
  } else  {
    state_mi(false);
  }
}

void state_fa(boolean act_guard) {
  do_action(buzzer, SHORT, NOTE_F, act_guard);
  boolean guard =  millis() - time > debounce;
  if (digitalRead(button1) == HIGH && guard) {
    time = millis();
    state_sol(true);
  } else  {
    state_fa(false);
  }
}

void state_sol(boolean act_guard) {
  do_action(buzzer, SHORT, NOTE_G, act_guard);
  boolean guard =  millis() - time > debounce;
  if (digitalRead(button1) == HIGH && guard) {
    time = millis();
    state_la(true);
  } else  {
    state_sol(false);
  }
}

void state_la(boolean act_guard) {
  do_action(buzzer, SHORT, NOTE_A, act_guard);
  boolean guard =  millis() - time > debounce;
  if (digitalRead(button1) == HIGH && guard) {
    time = millis();
    state_si(true);
  } else  {
    state_la(false);
  }
}

void state_si(boolean act_guard) {
  do_action(buzzer, SHORT, NOTE_B, act_guard);
  boolean guard =  millis() - time > debounce;
  if (digitalRead(button1) == HIGH && guard) {
    time = millis();
    state_do(true);
  } else  {
    state_si(false);
  }
}

void state_off(boolean act_guard) {
  do_action(led, OFF, HIGH, act_guard);
  do_action(buzzer, OFF, HIGH, act_guard);
  boolean guard =  millis() - time > debounce;
  if (digitalRead(button1) == HIGH && guard) {
    time = millis();
    state_do(true);
  } else  {
    state_off(false);
  }
}

void loop() {
  state_off(true);
}
